---
phase: 01-electron-foundation
plan: 02
type: execute
wave: 1
depends_on: [01-01]
files_modified: [forge.config.js, webpack.main.config.js, webpack.renderer.config.js]
autonomous: true
user_setup: []

must_haves:
  truths:
    - "Electron Forge configured with webpack plugin"
    - "Main process webpack configured for Electron target"
    - "Renderer webpack configured for Next.js integration"
    - "Entry points defined for main, renderer, and preload"
  artifacts:
    - path: "forge.config.js"
      provides: "Electron Forge configuration"
      min_lines: 20
      contains: ["plugins", "webpack"]
    - path: "webpack.main.config.js"
      provides: "Main process webpack configuration"
      min_lines: 15
      contains: ["target: 'electron-main'", "entry"]
    - path: "webpack.renderer.config.js"
      provides: "Renderer webpack configuration"
      min_lines: 15
      contains: ["target: 'web'"]
  key_links:
    - from: "forge.config.js"
      to: "webpack.main.config.js"
      via: "mainConfig reference"
      pattern: "mainConfig.*webpack.main.config"
    - from: "forge.config.js"
      to: "webpack.renderer.config.js"
      via: "renderer.config reference"
      pattern: "renderer.config.*webpack.renderer.config"
---

<objective>
Configure Electron Forge with webpack plugin for development and production builds.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-electron-foundation/01-RESEARCH.md
@.planning/phases/01-electron-foundation/01-01-SUMMARY.md
@package.json
</context>

<tasks>

<task type="auto">
  <name>Configure Electron Forge webpack plugin</name>
  <files>forge.config.js</files>
  <action>
    Create forge.config.js with:
    - packagerConfig: {} (default settings)
    - rebuildConfig: {} (for native modules)
    - makers: Array with @electron-forge/maker-zip for darwin platform
    - plugins: Array with @electron-forge/plugin-webpack
      * mainConfig: './webpack.main.config.js'
      * renderer.config: './webpack.renderer.config.js'
      * entryPoints: Array with single entry:
        - name: 'main_window'
        - html: './.next/server/app/page.html' (or dev equivalent)
        - js: './.webpack/renderer/index.js'
        - preload: { js: './preload/index.js' }

    Follow RESEARCH.md "Forge Configuration with Webpack" example
  </action>
  <verify>forge.config.js exists with webpack plugin configuration</verify>
  <done>Forge configured with webpack plugin for development and packaging</done>
</task>

<task type="auto">
  <name>Create webpack main config</name>
  <files>webpack.main.config.js</files>
  <action>
    Create webpack.main.config.js with:
    - mode: process.env.NODE_ENV || 'development'
    - target: 'electron-main'
    - node: { __dirname: false, __filename: false }
    - entry: './main/index.js'
    - output: { path: __dirname + '/.webpack', filename: 'main/[name].js' }
    - module: rules for .node files (node-loader) and JS/node files (@vercel/webpack-asset-relocator-loader)

    Follow RESEARCH.md "Webpack Main Config" example for native module support
  </action>
  <verify>webpack.main.config.js exists with electron-main target</verify>
  <done>Main process webpack config created with native module support</done>
</task>

<task type="auto">
  <name>Create webpack renderer config</name>
  <files>webpack.renderer.config.js</files>
  <action>
    Create webpack.renderer.config.js with:
    - mode: process.env.NODE_ENV || 'development'
    - target: 'web' (for Next.js integration with nodeIntegration: false)
    - entry: Use Next.js dev server in dev, packaged build in prod
    - output: { path: __dirname + '/.webpack', filename: 'renderer/[name].js' }
    - devServer: { static: directory for renderer, hot: true }

    NOTE: This config works with Electron Forge's webpack plugin to load Next.js.
    In dev: Forge HMR connects to Next.js dev server
    In prod: Packaged Next.js static export loads via loadFile
  </action>
  <verify>webpack.renderer.config.js exists with web target</verify>
  <done>Renderer webpack config created for Next.js integration</done>
</task>

</tasks>

<verification>
- Forge config references webpack configs
- Main process targets electron-main
- Renderer process targets web
- Entry points configured for all three bundles (main, renderer, preload)
</verification>

<success_criteria>
Electron Forge configured with webpack plugin for development and production builds.
</success_criteria>

<output>
After completion, create `.planning/phases/01-electron-foundation/01-02-SUMMARY.md`
</output>
